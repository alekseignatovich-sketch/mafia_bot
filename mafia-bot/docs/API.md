# API Documentation

## –ö–æ–º–∞–Ω–¥—ã –±–æ—Ç–∞

### –û—Å–Ω–æ–≤–Ω—ã–µ –∫–æ–º–∞–Ω–¥—ã

| –ö–æ–º–∞–Ω–¥–∞ | –û–ø–∏—Å–∞–Ω–∏–µ | –î–æ—Å—Ç—É–ø |
|---------|----------|--------|
| `/start` | –ù–∞—á–∞—Ç—å —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—é –∏–ª–∏ –ø–æ–∫–∞–∑–∞—Ç—å –ø—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ | –í—Å–µ |
| `/menu` | –ü–æ–∫–∞–∑–∞—Ç—å –≥–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é | –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ |
| `/profile` | –ü–æ–∫–∞–∑–∞—Ç—å –ø—Ä–æ—Ñ–∏–ª—å –∏–≥—Ä–æ–∫–∞ | –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ |
| `/city` | –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≥–æ—Ä–æ–¥–∞–º–∏ | –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ |
| `/language` | –°–º–µ–Ω–∏—Ç—å —è–∑—ã–∫ | –ó–∞—Ä–µ–≥–∏—Å—Ç—Ä–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ |
| `/help` | –ü–æ–∫–∞–∑–∞—Ç—å —Å–ø—Ä–∞–≤–∫—É | –í—Å–µ |
| `/admin` | –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å | –ê–¥–º–∏–Ω–∏—Å—Ç—Ä–∞—Ç–æ—Ä—ã |

### Callback Data

#### –ú–µ–Ω—é
- `menu:main` - –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é
- `menu:city` - –ú–µ–Ω—é –≥–æ—Ä–æ–¥–∞
- `menu:profile` - –ü—Ä–æ—Ñ–∏–ª—å
- `menu:journal` - –ñ—É—Ä–Ω–∞–ª
- `menu:settings` - –ù–∞—Å—Ç—Ä–æ–π–∫–∏
- `menu:language` - –í—ã–±–æ—Ä —è–∑—ã–∫–∞
- `menu:help` - –ü–æ–º–æ—â—å
- `menu:admin` - –ê–¥–º–∏–Ω-–ø–∞–Ω–µ–ª—å

#### –ì–æ—Ä–æ–¥
- `city:create` - –°–æ–∑–¥–∞—Ç—å –≥–æ—Ä–æ–¥
- `city:join` - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –≥–æ—Ä–æ–¥—É
- `city:list` - –°–ø–∏—Å–æ–∫ –≥–æ—Ä–æ–¥–æ–≤
- `city:view:{id}` - –ü—Ä–æ—Å–º–æ—Ç—Ä –≥–æ—Ä–æ–¥–∞
- `city:join:{id}` - –ü—Ä–∏—Å–æ–µ–¥–∏–Ω–∏—Ç—å—Å—è –∫ –≥–æ—Ä–æ–¥—É (ID)
- `city:leave:{id}` - –ü–æ–∫–∏–Ω—É—Ç—å –≥–æ—Ä–æ–¥

#### –ò–≥—Ä–∞
- `game:start:{city_id}` - –ù–∞—á–∞—Ç—å –∏–≥—Ä—É –≤ –≥–æ—Ä–æ–¥–µ
- `game:night_actions` - –ù–æ—á–Ω—ã–µ –¥–µ–π—Å—Ç–≤–∏—è
- `game:vote` - –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ
- `game:journal` - –ñ—É—Ä–Ω–∞–ª –∏–≥—Ä—ã
- `game:players` - –°–ø–∏—Å–æ–∫ –∏–≥—Ä–æ–∫–æ–≤

#### –î–µ–π—Å—Ç–≤–∏—è
- `action:kill` - –£–±–∏—Ç—å
- `action:heal` - –õ–µ—á–∏—Ç—å
- `action:investigate` - –ü—Ä–æ–≤–µ—Ä–∏—Ç—å
- `action:block` - –ë–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å
- `action:protect` - –ó–∞—â–∏—Ç–∏—Ç—å
- `action:skip` - –ü—Ä–æ–ø—É—Å—Ç–∏—Ç—å
- `action:cancel` - –û—Ç–º–µ–Ω–∞
- `action:back` - –ù–∞–∑–∞–¥
- `action:confirm` - –ü–æ–¥—Ç–≤–µ—Ä–¥–∏—Ç—å

#### –ì–æ–ª–æ—Å–æ–≤–∞–Ω–∏–µ
- `vote:{player_id}` - –ü—Ä–æ–≥–æ–ª–æ—Å–æ–≤–∞—Ç—å –∑–∞ –∏–≥—Ä–æ–∫–∞

#### –Ø–∑—ã–∫
- `lang:{code}` - –í—ã–±—Ä–∞—Ç—å —è–∑—ã–∫ (ru, en, be, de, es)

#### –ê–¥–º–∏–Ω
- `admin:new_city` - –°–æ–∑–¥–∞—Ç—å –Ω–æ–≤—ã–π –≥–æ—Ä–æ–¥
- `admin:start_event` - –ó–∞–ø—É—Å—Ç–∏—Ç—å —Å–æ–±—ã—Ç–∏–µ
- `admin:stats` - –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞
- `admin:broadcast` - –†–∞—Å—Å—ã–ª–∫–∞
- `admin:event:{type}` - –í—ã–±—Ä–∞—Ç—å —Ç–∏–ø —Å–æ–±—ã—Ç–∏—è

## –°—Ç—Ä—É–∫—Ç—É—Ä–∞ –¥–∞–Ω–Ω—ã—Ö

### Player
```json
{
  "id": 123456789,
  "telegram_id": 123456789,
  "username": "player_name",
  "first_name": "Player",
  "last_name": "Name",
  "level": 5,
  "experience": 25,
  "reputation": 15,
  "is_active": true,
  "is_banned": false,
  "language": "ru",
  "notifications_enabled": true,
  "games_played": 10,
  "games_won": 6,
  "games_lost": 4,
  "total_days_survived": 45
}
```

### City
```json
{
  "id": 1,
  "name": "Test City",
  "description": "A test city",
  "is_active": true,
  "is_private": false,
  "max_players": 20,
  "min_players": 4,
  "creator_id": 123456789,
  "day_duration_hours": 16,
  "night_duration_hours": 8,
  "player_count": 8
}
```

### Game
```json
{
  "id": 1,
  "city_id": 1,
  "status": "night",
  "day_number": 3,
  "phase_end_time": "2024-01-15T08:00:00Z",
  "winner_faction": null,
  "started_at": "2024-01-12T00:00:00Z",
  "ended_at": null
}
```

### Role
```json
{
  "id": 1,
  "name": "Mafia",
  "name_key": "mafia",
  "description_key": "roles.mafia.description",
  "role_type": "mafia",
  "team": "mafia",
  "can_kill": true,
  "can_heal": false,
  "can_investigate": false,
  "can_block": false,
  "action_priority": 3,
  "unlock_level": 1,
  "is_special": false
}
```

## –°–æ–±—ã—Ç–∏—è

### –¢–∏–ø—ã —Å–æ–±—ã—Ç–∏–π

| –°–æ–±—ã—Ç–∏–µ | –û–ø–∏—Å–∞–Ω–∏–µ | –≠—Ñ—Ñ–µ–∫—Ç |
|---------|----------|--------|
| `inquisitor` | –ü—Ä–∏–µ–∑–¥ –∏–Ω–∫–≤–∏–∑–∏—Ç–æ—Ä–∞ | –®–µ—Ä–∏—Ñ –≤–∏–¥–∏—Ç –≤—Å–µ —Ä–æ–ª–∏ |
| `mayor_election` | –í—ã–±–æ—Ä—ã –º—ç—Ä–∞ | –ú—ç—Ä –ø–æ–ª—É—á–∞–µ—Ç +1 –≥–æ–ª–æ—Å |
| `plague` | –ß—É–º–∞ | –°–ª—É—á–∞–π–Ω—ã–π –∏–≥—Ä–æ–∫ —Ç–µ—Ä—è–µ—Ç —Å–ø–æ—Å–æ–±–Ω–æ—Å—Ç—å |
| `full_moon` | –ü–æ–ª–Ω–æ–ª—É–Ω–∏–µ | –ú–∞–Ω—å—è–∫ –º–æ–∂–µ—Ç —É–±–∏—Ç—å 2 –∏–≥—Ä–æ–∫–æ–≤ |
| `curfew` | –ö–æ–º–µ–Ω–¥–∞–Ω—Ç—Å–∫–∏–π —á–∞—Å | –ù–µ–ª—å–∑—è –æ–±—â–∞—Ç—å—Å—è –¥–Ω—ë–º |
| `double_trouble` | –î–≤–æ–π–Ω–æ–π —É–¥–∞—Ä | –ú–∞—Ñ–∏—è –º–æ–∂–µ—Ç —É–±–∏—Ç—å 2 –∏–≥—Ä–æ–∫–æ–≤ |
| `revelation` | –û—Ç–∫—Ä–æ–≤–µ–Ω–∏–µ | –°–ª—É—á–∞–π–Ω–∞—è —Ä–æ–ª—å —Ä–∞—Å–∫—Ä—ã–≤–∞–µ—Ç—Å—è |

## –°–∏—Å—Ç–µ–º–∞ XP

### –§–æ—Ä–º—É–ª–∞ —É—Ä–æ–≤–Ω–µ–π
```
required_xp = level * 10
```

### –ù–∞—á–∏—Å–ª–µ–Ω–∏–µ XP
- –ó–∞ –∫–∞–∂–¥—ã–π –∏–≥—Ä–æ–≤–æ–π —Ü–∏–∫–ª: +1 XP
- –ü–æ–±–µ–¥–∞ –≤ –∏–≥—Ä–µ: √ó2 –º–Ω–æ–∂–∏—Ç–µ–ª—å
- –î–æ—Å—Ç–∏–∂–µ–Ω–∏—è: –æ—Ç 10 –¥–æ 100 XP

### –¢–∏—Ç—É–ª—ã –ø–æ —É—Ä–æ–≤–Ω—è–º
| –£—Ä–æ–≤–µ–Ω—å | –¢–∏—Ç—É–ª |
|---------|-------|
| 1-2 | –ù–æ–≤–∏—á–æ–∫ üå± |
| 3-4 | –û–ø—ã—Ç–Ω—ã–π –∏–≥—Ä–æ–∫ üåø |
| 5-6 | –ú–∞—Å—Ç–µ—Ä –∏–≥—Ä—ã üå≥ |
| 7-8 | –≠–∫—Å–ø–µ—Ä—Ç üèÜ |
| 9-10 | –õ–µ–≥–µ–Ω–¥–∞ üëë |
| 11+ | –ë–æ–≥ –∏–≥—Ä—ã üåü |

## –†–æ–ª–∏ –∏ –ø—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã

### –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç—ã –¥–µ–π—Å—Ç–≤–∏–π (–º–µ–Ω—å—à–µ = —Ä–∞–Ω—å—à–µ)

| –ü—Ä–∏–æ—Ä–∏—Ç–µ—Ç | –†–æ–ª—å | –î–µ–π—Å—Ç–≤–∏–µ |
|-----------|------|----------|
| 1 | –¢–µ–ª–æ—Ö—Ä–∞–Ω–∏—Ç–µ–ª—å | –ó–∞—â–∏—Ç–∞ |
| 1 | –ú–∞–Ω—å—è–∫ | –£–±–∏–π—Å—Ç–≤–æ |
| 2 | –ö—É–ø–∏–¥–æ–Ω | –°–≤—è–∑—ã–≤–∞–Ω–∏–µ |
| 2 | –ü—É—Ç–∞–Ω–∞ | –ë–ª–æ–∫–∏—Ä–æ–≤–∫–∞ |
| 3 | –ú–∞—Ñ–∏—è | –£–±–∏–π—Å—Ç–≤–æ |
| 3 | –î–æ–Ω | –£–±–∏–π—Å—Ç–≤–æ/–ü—Ä–æ–≤–µ—Ä–∫–∞ |
| 4 | –î–æ–∫—Ç–æ—Ä | –õ–µ—á–µ–Ω–∏–µ |
| 5 | –®–µ—Ä–∏—Ñ | –ü—Ä–æ–≤–µ—Ä–∫–∞ |
| 10 | –ú–∏—Ä–Ω—ã–π | ‚Äî |
